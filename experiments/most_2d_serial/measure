#! /usr/bin/env python

import itertools as it
import subprocess

import numpy as np

import fireperf.form
import fireperf.mesh


FORM_TYPES = fireperf.form.FORM_TYPES
MESH_TYPES = fireperf.mesh.MESH_TYPES_2D
MESH_SIZES = np.logspace(2, 8, 15, base=2, dtype=np.int)
DEGREES = range(1, 4)
REPEATS = 5
METADATA_FNAME = "metadata.csv"


params = it.product(FORM_TYPES, MESH_TYPES, MESH_SIZES, DEGREES)

for form_type, mesh_type, mesh_size, degree in params:
    log_fname = f"{form_type}_{mesh_type}_{mesh_size}_{degree}.txt"

    cmd = ["assemble-form", form_type, mesh_type, str(mesh_size), str(degree),
           str(REPEATS), log_fname, METADATA_FNAME]

    print(" ".join(cmd))
    subprocess.run(cmd)
